<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Conditional Table GAN (CTAB-GAN)" href="ctabgan.html" /><link rel="prev" title="Conditional Tabular GAN (CTGAN)" href="ctgan.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2023.09.10 -->
        <title>TVAE - Clover documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=369552022d0b975c8e74270ce6eabe0fb7978f24" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  --color-brand-primary: #7C4DFF;
  --color-brand-content: #7C4DFF;
  --color-problematic: #00b377;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  --color-brand-primary: #926bff;
  --color-brand-content: #926bff;
  --color-problematic: #00b377;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  --color-brand-primary: #926bff;
  --color-brand-content: #926bff;
  --color-problematic: #00b377;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Clover  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Clover  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../home/clover.html">What is Clover?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../home/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../home/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../home/getting_involved.html">Getting Involved</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../home/license.html">MIT License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="modules.html">Generators</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Generators</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="datasynthesizer.html">DataSynthesizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="synthpop.html">Synthpop</a></li>
<li class="toctree-l2"><a class="reference internal" href="smote.html">SMOTE</a></li>
<li class="toctree-l2"><a class="reference internal" href="mst.html">Private-PGM - MST</a></li>
<li class="toctree-l2"><a class="reference internal" href="ctgan.html">Conditional Tabular GAN (CTGAN)</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">TVAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="ctabgan.html">Conditional Table GAN (CTAB-GAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="findiff.html">FinDiff</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../metrics/modules.html">Metrics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Metrics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../metrics/utility.html">Utility Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/privacy.html">Privacy Metrics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../optimization/modules.html">Optimization</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Optimization</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../optimization/pso.html">Discrete Particle Swarm Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization/optuna.html">Hyperparameter tuning with Optuna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization/raytune.html">Parallel hyperparameter tuning with RayTune</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../API/generators/modules.html">Generators API</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Generators API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../API/generators/generators.html">generators</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../API/metrics/modules.html">Metrics API</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Metrics API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../API/metrics/metrics.html">metrics</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of metrics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../API/metrics/metrics.utility.html">metrics.utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../API/metrics/metrics.privacy.html">metrics.privacy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../API/optimization/modules.html">Optimization API</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Optimization API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../API/optimization/optimization.html">optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../API/utils/modules.html">Utilities API</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Utilities API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../API/utils/utils.html">utils</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/synthetic_data_generation.html">Synthetic Data Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/utility_report.html">How to generate a utility report?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/privacy_report.html">How to generate a membership inference attacks report?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/tune_hyperparameters.html">Synthetic Data Generation – Find the best hyperparameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/combined_report.html">How to generate a combined utility/privacy report?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/metareport.html">How to generate a metareport?</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="tvae">
<h1>TVAE<a class="headerlink" href="#tvae" title="Permalink to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>Autoencoders are a type of artificial neural network used for learning efficient representations of data. They consist of an encoder network that maps the input data into a latent space representation and a decoder network that reconstructs the input data from the latent space. Variational autoencoders (VAEs) are a specific type of autoencoder trained to generate new data samples from the learned latent space in a way that takes into consideration the variability in the original sample and ensures continuity and smoothness of the generated samples. VAEs can be used for synthetic data generation by sampling from the learned latent space to produce new, artificial data that resembles the original data.</p>
<p>Latent space representation is one of the central aspects of VAEs that enables it to capture the underlying structure and variations present in the input data, condensing it into a continuous, low-dimensional space. This latent space has the essential characteristics of the dataset, facilitating the generation of new data points similar to those observed in the original dataset. By sampling from different regions within the latent space and decoding these samples, VAEs can generate synthetic data points that correspond to the statistical properties of the input data. In practical applications, VAEs find utility in various domains. In healthcare, for instance, VAEs can learn the statistical distributions of patient data and produce synthetic patient records that preserve key characteristics while safeguarding privacy. Furthermore, VAEs contribute to data augmentation efforts by generating synthetic data points to supplement existing datasets, thereby enhancing the performance of machine learning models.</p>
<p>The implementation that is used here is based on the <a class="reference external" href="https://github.com/sdv-dev/CTGAN/blob/main/ctgan/synthesizers/tvae.py">TVAE</a> model for synthetic data generation. TVAE consists of an encoder and a decoder, where the encoder compresses the input data into a lower-dimensional latent space, and the decoder reconstructs the original data from this latent representation. The <code class="docutils literal notranslate"><span class="pre">Encoder</span></code> class takes as input the dimensions of the data, the size of each hidden layer (<code class="docutils literal notranslate"><span class="pre">compress_dims</span></code>), and the size of the output vector (<code class="docutils literal notranslate"><span class="pre">embedding_dim</span></code>). The encoder applies a sequence of linear transformations followed by ReLU activation functions to map the input data to the latent space. It then outputs the mean (<code class="docutils literal notranslate"><span class="pre">mu</span></code>), standard deviation (<code class="docutils literal notranslate"><span class="pre">std</span></code>), and logarithm of the variance (<code class="docutils literal notranslate"><span class="pre">logvar</span></code>) of the latent representation. The <code class="docutils literal notranslate"><span class="pre">Decoder</span></code> class takes as input the size of the input vector (<code class="docutils literal notranslate"><span class="pre">embedding_dim</span></code>), the size of each hidden layer (<code class="docutils literal notranslate"><span class="pre">decompress_dims</span></code>), and the dimensions of the original data. Similar to the encoder, the decoder applies a sequence of linear transformations followed by ReLU activation functions to reconstruct the original data from the latent space.
The loss function calculates the reconstruction loss and the Kullback-Leibler divergence, which measures the difference between the learned latent distribution and a standard normal distribution.</p>
<p>Below is the pseudo code for the <a class="reference external" href="https://github.com/sdv-dev/CTGAN/blob/main/ctgan/synthesizers/tvae.py">TVAE algorithm</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">Instantiate</span> <span class="n">TVAE</span> <span class="k">with</span> <span class="n">hyperparameters</span>
<span class="mf">2.</span> <span class="n">Fit</span> <span class="n">TVAE</span> <span class="n">model</span> <span class="n">to</span> <span class="n">training</span> <span class="n">data</span>
<span class="mf">3.</span> <span class="n">Generate</span> <span class="n">synthetic</span> <span class="n">data</span> <span class="n">using</span> <span class="n">TVAE</span> <span class="n">model</span>

<span class="n">Initialize</span> <span class="n">TVAE</span> <span class="n">algorithm</span> <span class="k">with</span> <span class="n">hyperparameters</span><span class="p">:</span>
<span class="o">-</span> <span class="n">embedding_dim</span>
<span class="o">-</span> <span class="n">compress_dims</span>
<span class="o">-</span> <span class="n">decompress_dims</span>

<span class="n">Define</span> <span class="n">Encoder</span> <span class="n">class</span><span class="p">:</span>
<span class="o">-</span> <span class="n">Initialize</span> <span class="k">with</span> <span class="n">data_dim</span><span class="p">,</span> <span class="n">compress_dims</span><span class="p">,</span> <span class="n">embedding_dim</span>
<span class="o">-</span> <span class="n">Produces</span> <span class="n">mean</span><span class="p">,</span> <span class="n">standard</span> <span class="n">deviation</span><span class="p">,</span> <span class="ow">and</span> <span class="n">logvariance</span>
<span class="o">-</span> <span class="n">Define</span> <span class="n">forward</span> <span class="n">method</span> <span class="n">to</span> <span class="n">encode</span> <span class="nb">input</span> <span class="n">data</span>

<span class="n">Define</span> <span class="n">Decoder</span> <span class="n">class</span><span class="p">:</span>
<span class="o">-</span> <span class="n">Initialize</span> <span class="k">with</span> <span class="n">embedding_dim</span><span class="p">,</span> <span class="n">decompress_dims</span><span class="p">,</span> <span class="n">data_dim</span>
<span class="o">-</span> <span class="n">Define</span> <span class="n">forward</span> <span class="n">method</span> <span class="n">to</span> <span class="n">decode</span> <span class="nb">input</span> <span class="n">data</span>

<span class="n">Define</span> <span class="n">loss_function</span> <span class="n">to</span> <span class="n">compute</span> <span class="n">loss</span><span class="p">:</span>
<span class="o">-</span> <span class="n">Compute</span> <span class="n">the</span> <span class="n">reconstruction</span><span class="o">/</span><span class="n">divergence</span> <span class="n">loss</span>

<span class="n">Define</span> <span class="n">TVAE</span> <span class="n">class</span><span class="p">:</span>
<span class="o">-</span> <span class="n">Initialize</span> <span class="k">with</span> <span class="n">hyperparameters</span>
<span class="o">-</span> <span class="n">Define</span> <span class="n">fit</span> <span class="n">method</span> <span class="n">to</span> <span class="n">train</span> <span class="n">the</span> <span class="n">TVAE</span> <span class="n">model</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">Transform</span> <span class="nb">input</span> <span class="n">data</span>
  <span class="o">-</span> <span class="n">Initialize</span> <span class="n">Encoder</span> <span class="ow">and</span> <span class="n">Decoder</span>
  <span class="o">-</span> <span class="n">Iterate</span> <span class="n">through</span> <span class="n">epochs</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">Iterate</span> <span class="n">through</span> <span class="n">batches</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">Compute</span> <span class="n">encoder</span> <span class="n">output</span>
      <span class="o">-</span> <span class="n">Compute</span> <span class="n">decoder</span> <span class="n">output</span>
      <span class="o">-</span> <span class="n">Compute</span> <span class="n">loss</span>
      <span class="o">-</span> <span class="n">Update</span> <span class="n">model</span> <span class="n">parameters</span>

<span class="n">Define</span> <span class="n">sample</span> <span class="n">method</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">synthetic</span> <span class="n">data</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">Generate</span> <span class="n">synthetic</span> <span class="n">data</span> <span class="n">based</span> <span class="n">on</span> <span class="nb">input</span> <span class="n">samples</span>
</pre></div>
</div>
<p>Here’s a breakdown of each step:</p>
<ol class="arabic simple">
<li><p><strong>Encoder Class (Initialization and Forward Pass)</strong>:</p>
<ul class="simple">
<li><p>Initialize the Encoder class with <code class="docutils literal notranslate"><span class="pre">data_dim</span></code>, <code class="docutils literal notranslate"><span class="pre">compress_dims</span></code>, and <code class="docutils literal notranslate"><span class="pre">embedding_dim</span></code>.</p></li>
<li><p>A sequence of linear layers followed by ReLU activation functions based on the <code class="docutils literal notranslate"><span class="pre">compress_dims</span></code>.</p></li>
<li><p>Define linear layers to produce the mean <code class="docutils literal notranslate"><span class="pre">mu</span></code> and log variance <code class="docutils literal notranslate"><span class="pre">logvar</span></code> of the latent space.</p></li>
<li><p>Implement the <code class="docutils literal notranslate"><span class="pre">forward</span></code> method to encode the input data, where the input passes through the sequential layers, and then produces <code class="docutils literal notranslate"><span class="pre">mu</span></code>, <code class="docutils literal notranslate"><span class="pre">std</span></code> (standard deviation), and <code class="docutils literal notranslate"><span class="pre">logvar</span></code>.</p></li>
</ul>
</li>
<li><p><strong>Decoder Class (Initialization and Forward Pass)</strong>:</p>
<ul class="simple">
<li><p>Initialize the Decoder class with <code class="docutils literal notranslate"><span class="pre">embedding_dim</span></code>, <code class="docutils literal notranslate"><span class="pre">decompress_dims</span></code>, and <code class="docutils literal notranslate"><span class="pre">data_dim</span></code>.</p></li>
<li><p>Construct a sequence of linear layers followed by ReLU activation functions based on the <code class="docutils literal notranslate"><span class="pre">decompress_dims</span></code>.</p></li>
<li><p>Add a linear layer at the end to produce the output data.</p></li>
<li><p>Additionally, create a <code class="docutils literal notranslate"><span class="pre">sigma</span></code> parameter to model the uncertainty of the reconstructed data.</p></li>
<li><p>Implement the <code class="docutils literal notranslate"><span class="pre">forward</span></code> method to decode the input vector, where the input passes through the sequential layers to produce the reconstructed data.</p></li>
</ul>
</li>
<li><p><strong>Loss Function</strong>:</p>
<ul class="simple">
<li><p>Define a loss function to compute the reconstruction loss/Kullback-Leibler divergence loss.</p></li>
<li><p>Iterate over the output_info to compute the loss for each column of the data.</p></li>
<li><p>Compute the reconstruction loss and Kullback-Leibler divergence loss, and return their sum.</p></li>
</ul>
</li>
<li><p><strong>TVAE Class (Initialization, Fit, Sample, and Set Device)</strong>:</p>
<ul class="simple">
<li><p>Initialize the TVAE class with various hyperparameters including <code class="docutils literal notranslate"><span class="pre">embedding_dim</span></code>, <code class="docutils literal notranslate"><span class="pre">compress_dims</span></code>, <code class="docutils literal notranslate"><span class="pre">decompress_dims</span></code>, etc.</p></li>
<li><p>Define the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method to train the TVAE model on the input data:</p>
<ul>
<li><p>Iterate through epochs and batches, compute encoder and decoder outputs, compute loss, and update model parameters accordingly.</p></li>
</ul>
</li>
<li><p>Define the <code class="docutils literal notranslate"><span class="pre">sample</span></code> method to generate synthetic data similar to the training data using the trained Decoder:</p>
<ul>
<li><p>Generate noise vectors, pass them through the Decoder, and transform the generated data back to the original space.</p></li>
</ul>
</li>
</ul>
</li>
</ol>
</section>
<section id="clover-implementation">
<h2>Clover implementation<a class="headerlink" href="#clover-implementation" title="Permalink to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Also a wrapper of a data synthesizer available in the SDV package.</span>
<span class="sd">The synthesizer is TVAE, a VAE for tabular data.</span>
<span class="sd">https://github.com/sdv-dev</span>

<span class="sd">:param df: the data to synthesize</span>
<span class="sd">:param metadata: a dictionary containing the list of **continuous** and **categorical** variables</span>
<span class="sd">:param random_state: for reproducibility purposes</span>
<span class="sd">:param generator_filepath: the path of the generator to sample from if it exists</span>
<span class="sd">:param discriminator_steps: the number of discriminator updates to do for each generator update.</span>
<span class="sd">:param epochs: the number of training epochs.</span>
<span class="sd">:param batch_size: the batch size for training.</span>
<span class="sd">:param compress_dims: the size of the hidden layers in the encoder.</span>
<span class="sd">:param decompress_dims: the size of the hidden layers in the decoder.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">Steps</span> <span class="n">include</span><span class="p">:</span>
<span class="n">Preparing</span> <span class="n">the</span> <span class="n">parameters</span> <span class="n">to</span> <span class="n">train</span> <span class="n">the</span> <span class="n">generator</span><span class="o">.</span>
<span class="n">Train</span> <span class="n">the</span> <span class="n">generator</span> <span class="ow">and</span> <span class="n">save</span> <span class="n">it</span><span class="o">.</span>
<span class="n">Generate</span> <span class="n">samples</span> <span class="n">using</span> <span class="n">the</span> <span class="n">synthesizer</span> <span class="n">trained</span> <span class="n">on</span> <span class="n">the</span> <span class="n">real</span> <span class="n">data</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/sdv-dev/SDV">https://github.com/sdv-dev/SDV</a></p></li>
<li><p><a class="reference external" href="https://github.com/sdv-dev/SDV/blob/main/sdv/single_table/ctgan.py">https://github.com/sdv-dev/SDV/blob/main/sdv/single_table/ctgan.py</a></p></li>
<li><p><a class="reference external" href="https://github.com/sdv-dev/CTGAN/blob/main/ctgan/synthesizers/tvae.py">https://github.com/sdv-dev/CTGAN/blob/main/ctgan/synthesizers/tvae.py</a></p></li>
<li><p><a class="reference external" href="https://sdv.dev/SDV/user_guides/single_table/tvae.html">TVAE Model</a></p></li>
<li><p><a class="reference external" href="https://docs.sdv.dev/sdv/single-table-data/modeling/synthesizers/tvaesynthesizer">TVAESynthesizer</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/1907.00503.pdf">Modeling Tabular data using Conditional GAN</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1312.6114">Auto-Encoding Variational Bayes</a></p></li>
<li><p><a class="reference external" href="https://www.oreilly.com/library/view/hands-on-machine-learning/9781098125967/">Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow, 3rd Edition</a></p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="ctabgan.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Conditional Table GAN (CTAB-GAN)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="ctgan.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Conditional Tabular GAN (CTGAN)</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, IVADO PRF3 Human Health
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">TVAE</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#clover-implementation">Clover implementation</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>